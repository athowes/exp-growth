---
title: "Scoping Poisson regression"
author: "Adam Howes"
output:
  html_document:
    toc: yes
    df_print: paged
    code_folding: show
abstract: |
    **Background** Detecting exponential growth is a central goal of the Nucleic Acid Observatory (NAO). Regression using a Poisson generalised linear model (GLM) is possibly the simplest statistical approach to detecting exponential growth. 
    
    **Task** We aim to scope the statistical and computational feasibility of Poisson regression as a viable baseline method for exponential growth detection.
---

## Background

### What is the Poisson distribution

The Poisson distribution is a discrete probability distribution for the number of events occurring in a fixed interval (e.g. of time or space) when the events have a constant rate and occur independently.
If $y$ follows a Poisson distribution with rate $\lambda$ then we write
$$
y \sim \text{Pois}(\lambda).
$$

Why might this distribution be relevant to the NAO?
The Poisson distribution is a reasonable first model for how often we see a particular k-mer.
For example, suppose $\lambda = 10$ copies per day.
That means we expect to see on average 10 copies in any given day, but naturally there will be some variation.
It might be reasonable to describe that variation, to a first approximation, with a Poisson distribution^[In reality, you might be thinking that k-mers do not arise independently (and I think you’d be right!). That’s something we might want to think about attending to eventually.] 

<Insert R plot>

The NAO will not just observe k-mers on one day, but on many consecutive days.
We represent the number of k-mers observed on day $t$ as $y_t$.
For example, over a 14 day period we might collect the data
$$
(y_1 , y_2, y_3, y_4, \ldots, y_{13}, y_{14}).
$$

often called a time-series.
At each time $t$ we could assume that the data follows a Poisson distribution with daily rate $\lambda_t$
$$
y_t \sim \text{Pois}(\lambda_t).
$$
Suppose that the rate doesn’t change by day, and $\lambda_t = 10$ for all days.
We can simulate a draw from this time-series as follows:

```{r}
y <- rpois(14, 10)
plot(y)
```

While this data happens to have a constant rate, there is no reason that has to be the case.
When we see some new time-series data, we would like to learn the values of $\lambda_t$ which generated it.
This can be done using Poisson regression!

### What is Poisson regression

Because any rate parameter must be greater than zero $\lambda_t > 0$ (try to think about what it would mean for a rate to be negative) then we can’t just use a linear equation of the form
$$
\lambda_t= \beta_0 + \beta_1 x_{1t} + \cdots + \beta_{p}x_{pt} = \beta^\top x
$$
like we would in a linear regression.
Instead, we use an (inverse) link function $g^{-1}: \mathbb{R} \to \mathbb{R}^{+}$ which maps from the real numbers to the positive numbers
$$
\lambda_t = g^{-1}(\beta^\top x).
$$
Linear models like this where we use a link function are called generalised linear models (GLMs).
In Poisson regression, we use the exponential function as a link
$$
\lambda_t = \exp(\beta^\top x).
$$
This model can be expressed fully as follows (where the logarithm function is the inverse of the exponential)
$$
y_t \sim \text{Pois}(\lambda_t), \\
\log(\lambda_t) = \beta^\top x.
$$

### Why might this approach work to detect exponential growth

Suppose that we think that our underlying Poisson rate is exponentially increasing.
We could choose to use a model which includes an intercept $\beta_0$ and one covariate $x$ which represents the time $t$
$$
\log(\lambda_t) = \beta_0 + \beta t
$$

If we fit this model to data, and find that a point estimate for the $\beta$ parameter is $\hat \beta = 1$ then this would correspond to an underlying Poisson rate $\lambda_t$ which increases exponentially, exactly what we would like to detect!

```{r}
#' We suppose that the intercept is estimated to be zero
exp(0 + 1:14 * 1)
```

So, a simple method for detecting exponential growth is to **fit this Poisson regression model then look at the inference for the slope parameter $\beta$ and assess if it is sufficiently above zero.**

### A note on offsets

[TODO] You could "offset" some measure of the total amount.

## Statistical performance

[TODO] How well would this actually work?

## Computational performance

[TODO] Would it be computationally feasible?
Poisson regression is a simple method as statistical models go, so if it's not computationally feasible then we are in trouble.
The computational feasibility depends on exactly what we mean by "Poisson regression".
There are many different algorithms that could be used for computation, and they have different properties.
See e.g. https://en.wikipedia.org/wiki/Maximum_likelihood_estimation#Iterative_procedures.

### Time costs

[TODO] What is the runtime?

### Storage costs

[TODO] How much storage does it require?
