---
title: "qPCR generative model draft"
author: "Adam Howes"
date: '2022-06-16'
output:
  pdf_document: default
  html_document: default
---

* Let $i$ index the well position
* Initially there are $N_{i0}$ copies of the virus
* For each copy, consider that processing (i.e. DNA being released from inside the phage capsid) occurs independently between copies and is successful with probability $r_i$ ("release") drawn from some prior e.g. $r_i \sim \text{Beta}(a, b)$
* During dilution, a known fixed proportion $d_i \in [0, 1]$ ("dilution") of the copies are independently sampled, before being added to a known fixed amount of water
  * How does the fixed amount of water change things statistically?
* Call the number of copies of the virus retained $n_{i0}$, then we have
\begin{align}
p_i &\sim \text{Beta}(a, b), \\
n_{i0} &\sim \text{Binomial}(N_{i0}, r_i d_i).
\end{align}
* Now for the amplification PCR reaction suppose that the number of copies $n_{it}$ at cycle $t \in \mathbb{N}^+$ is
$$
n_{it} = n_{i0} (1 + E)^t
$$
where the efficiency $E$ has some prior, likely centered on one.
* Number of copies $n_{it}$ is connected to flourescene data $f_{it}$ by $f_{it} \sim g(n_{it})$
  * What's $g$?
* We observe $(f_{0t}, \ldots, f_{iT})$ where $T$ is the total number of PCR cycles run
* We want to infer $N_{i0}$
* Infer $C_q$ value 

## To-do

* Add indexes for other relevant features (e.g. treatment)
