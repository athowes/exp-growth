---
title: "A generative model for qPCR data"
author: "Adam Howes"
bibliography: citations.bib
output:
  pdf_document: default
---

# Background

[TODO]

# Statistical model

Suppose that there are initially $N_0 \in \mathbb{N}^+$ copies of the virus.
[TODO: Let $i$ index the well position and add indexes for other relevant features (e.g. treatment)]

## Processing and dilution

[TODO: Diagram of processing and dilution]

We first consider a processing step e.g. DNA being released from inside the phage capsid which occurs independently between copies
This step is successful with probability $r$ drawn from some prior e.g. $r \sim \text{Beta}(a, b)$.

Next, during dilution, a known fixed proportion $d \in [0, 1]$ of the copies are independently sampled, before being added to a known fixed amount of water.
[TODO: How to include the water in the model]
If the the number of copies of the virus retained is $n_0$, then we have
\begin{align}
p &\sim \text{Beta}(a, b), \\
n_0 &\sim \text{Binomial}(N_0, r d).
\end{align}

## Amplification

Suppose that the number of copies during amplification at cycle $t \in \mathbb{N}^+$ is $n_t$.
Amplification typically results in a logistic curve which may be described by parameteric models.
Two possible strategies are: (1) model the exponential component of the logistic curve, (2) model the complete curve [@ritz2008qpcr].

For the first strategy, the exponential component must be isolated, before modelling the exponential growth according to
$$
n_t = n_0 (1 + E)^t
$$
where the efficiency $E$ might have some prior centered at one.

We consider two possible models for the complete logistic curve.
The four-parameter logistic model (4PL) is of the form
$$
n_t = n_\infty + \frac{n_0 - n_\infty}{\left(1 + (t / m)^\beta \right)}
$$
where $n_\infty = \lim_{t \to \infty} n_t$ is the asympotote of the curve at infinity, and $n_0 = \lim_{t \to 0} n_t$ is the estimated initial number of copies, $\beta$ is the slope and $m$ is the midpoint.
[TODO: Better name for $m$].

The five-parameter logistic model (5PL) is similar to the four-parameter, but with an additional parameter $s$ which accounts for asymmetry
$$
n_t = n_\infty + \frac{n_0 - n_\infty}{\left(1 + (t / m)^\beta \right)^s}
$$
The number of copies $n_t$ is connected to fluorescence data $f_t$ by some function $g$ such that $f_t \sim g(n_t)$.
For now, we will consider that this relationship is linear such that
$$
f_t = \beta_0 + \beta \cdot n_t 
$$
where $\beta_0$ is the background fluouresence and $\beta$ is the fluoresence produced by a single count.

We observe $(f_0, \ldots, f_T)$ where $T$ is the total number of PCR cycles run.
The aim of our analysis is to infer $N_0$, as well as the $C_q$ value for comparison against the software generated value. 

# Implementation

We will build and expand our model step-by-step using the Stan probabilistic programming language...

# Bibliography 
